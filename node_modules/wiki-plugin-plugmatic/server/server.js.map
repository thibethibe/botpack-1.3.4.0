{
  "version": 3,
  "names": [
    "async",
    "execFile",
    "fs",
    "github",
    "glob",
    "https",
    "jsonfile",
    "startServer",
    "require",
    "path",
    "done",
    "e",
    "options",
    "req",
    "host",
    "port",
    "method",
    "get",
    "res",
    "data",
    "setEncoding",
    "on",
    "d",
    "error",
    "params",
    "admin",
    "app",
    "argv",
    "bundle",
    "farm",
    "info",
    "plugmap",
    "route",
    "view",
    "date",
    "Date",
    "now",
    "JSON",
    "parse",
    "endpoint",
    "file",
    "packageDir",
    "concat",
    "authors",
    "birth",
    "factory",
    "packagejson",
    "pages",
    "plugin",
    "site",
    "slice",
    "cb",
    "stat",
    "err",
    "ref",
    "birthtime",
    "getTime",
    "synopsis",
    "slug",
    "cb2",
    "readFile",
    "page",
    "ref1",
    "ref2",
    "ref3",
    "title",
    "story",
    "text",
    "readdir",
    "slugs",
    "map",
    "series",
    "cwd",
    "files",
    "install",
    "pkg",
    "test",
    "stdout",
    "stderr",
    "npm",
    "next",
    "f",
    "status",
    "send",
    "user",
    "securityhandler",
    "isAdmin",
    "session",
    "passport",
    "email",
    "friend",
    "i",
    "j",
    "k",
    "len",
    "len1",
    "p",
    "length",
    "json",
    "sendStatus",
    "_ref",
    "apply",
    "_toConsumableArray",
    "results1",
    "post",
    "installed",
    "payload",
    "published",
    "body",
    "plugins",
    "results",
    "publish",
    "parallel",
    "setHeader",
    "pipe",
    "version",
    "console",
    "log",
    "row",
    "process",
    "exit",
    "module",
    "exports"
  ],
  "sources": [
    "server.coffee"
  ],
  "sourcesContent": [
    "# plugmatic plugin, server-side component\n# These handlers are launched with the wiki server.\n\nfs = require 'fs'\nglob = require 'glob'\nasync = require 'async'\njsonfile = require 'jsonfile'\nhttps = require 'https'\nexecFile = require('child_process').execFile\n\n\ngithub = (path, done) ->\n  options =\n    host: 'raw.githubusercontent.com'\n    port: 443\n    method: 'GET'\n    path: path\n  try\n    req = https.get options, (res) ->\n      res.setEncoding 'utf8'\n      data = ''\n      res.on 'error', () ->\n        done null\n      res.on 'timeout', () ->\n        done null\n      res.on 'data', (d) ->\n        data += d\n      res.on 'end', () ->\n        done data\n    req.on 'error', () ->\n      done null\n  catch e\n    done null\n\n# http://www.sebastianseilund.com/nodejs-async-in-practice\n\nstartServer = (params) ->\n  app = params.app\n  argv = params.argv\n  bundle = null\n\n  github '/fedwiki/wiki/master/package.json', (data) ->\n    bundle =\n      date: Date.now()\n      data: JSON.parse data||'{\"dependencies\":{}}'\n\n  route = (endpoint) -> \"/plugin/plugmatic/#{endpoint}\"\n  path = (file) -> \"#{argv.packageDir}/#{file}\"\n\n\n  info = (file, done) ->\n    plugin = file.slice 12\n    site = {plugin}\n\n    birth = (cb) ->\n      fs.stat path(\"#{file}/client/#{plugin}.js\"), (err, stat) ->\n        site.birth = stat?.birthtime?.getTime(); cb()\n    pages = (cb) ->\n      synopsis = (slug, cb2) ->\n        jsonfile.readFile path(\"#{file}/pages/#{slug}\"), {throws:false}, (err, page) ->\n          title = page.title || slug\n          synopsis = page.story?[0]?.text || page.story?[1]?.text || 'empty'\n          cb2 null, {file, slug, title, synopsis}\n      fs.readdir path(\"#{file}/pages\"), (err, slugs) ->\n        async.map slugs||[], synopsis, (err, pages) ->\n          site.pages = pages; cb()\n    packagejson = (cb) ->\n      jsonfile.readFile path(\"#{file}/package.json\"), {throws:false}, (err, packagejson) ->\n        site.package = packagejson; cb()\n    factory = (cb) ->\n      jsonfile.readFile path(\"#{file}/factory.json\"), {throws:false}, (err, factory) ->\n        site.factory = factory; cb()\n    authors = (cb) ->\n      fs.readFile path(\"#{file}/AUTHORS.txt\"), 'utf-8', (err, authors) ->\n        site.authors = authors; cb()\n    # persona = (cb) ->\n    #   fs.readFile path(\"#{file}/status/persona.identity\"),'utf8', (err, identity) ->\n    #     site.persona = identity; cb()\n    # openid = (cb) ->\n    #   fs.readFile path(\"#{file}/status/open_id.identity\"),'utf8', (err, identity) ->\n    #     site.openid = identity; cb()\n    async.series [birth,authors,packagejson,factory,pages], (err) ->\n      done null, site\n\n  plugmap = (done) ->\n    glob \"wiki-plugin-*\", {cwd: argv.packageDir}, (err, files) ->\n      return done(err,null) if err\n      async.map files||[], info, (err, install) ->\n        return done(err,null) if err\n        done(null, install)\n\n\n  view = (plugin, done) ->\n    if /^\\w+$/.test(plugin)\n      pkg = \"wiki-plugin-#{plugin}\"\n      execFile 'npm', ['view', \"#{pkg}\", '--json'], (err, stdout, stderr) ->\n        try npm = JSON.parse stdout\n        done null, {plugin, pkg, npm}\n\n  farm = (req, res, next) ->\n    if argv.f\n      next()\n    else\n      res.status(404).send {error: 'service requires farm mode'}\n\n  admin = (req, res, next) ->\n    if app.securityhandler.isAdmin(req)\n      next()\n    else\n      admin = \"none specified\" unless argv.admin\n      user = \"not logged in\" unless req.session?.passport?.user || req.session?.email || req.session?.friend\n      res.status(403).send {error: 'service requires admin user', admin, user}\n\n  app.get route('page/:slug.json'), (req, res) ->\n    plugmap (err, install) ->\n      for i in install\n        for p in i.pages\n          if p.slug is req.params.slug\n            return jsonfile.readFile path(\"#{p.file}/pages/#{p.slug}\"), {throws:false}, (err, page) ->\n              res.json page\n      res.sendStatus 404\n\n  app.get route('file/:file/slug/:slug'), (req, res) ->\n    jsonfile.readFile path(\"#{req.params.file}/pages/#{req.params.slug}\"), {throws:false}, (err, page) ->\n      if err\n        res.sendStatus 404\n      else\n        res.json page\n\n  app.get route('sitemap.json'), (req, res) ->\n    plugmap (err, install) ->\n      # http://stackoverflow.com/a/4631593\n      res.json [].concat (i.pages for i in install)...\n\n  app.get route('plugins'), (req, res) ->\n    glob \"wiki-plugin-*\", {cwd: argv.packageDir}, (err, files) ->\n      return res.e err if err\n      async.map files||[], info, (err, install) ->\n        return res.e err if err\n        res.json {install, bundle}\n\n  app.post route('plugins'), (req, res) ->\n    payload = {bundle}\n\n    installed = (cb) ->\n      files = (\"wiki-plugin-#{plugin}\" for plugin in req.body.plugins||[])\n      async.map files||[], info, (err, install) ->\n        payload.install = install; cb()\n\n    published = (cb) ->\n      async.map req.body.plugins||[], view, (err, results) ->\n        payload.publish = results; cb()\n\n    async.parallel [installed, published], (err) ->\n      res.json payload\n\n  app.get route('view/:pkg'), (req, res) ->\n    if /^\\w+$/.test(req.params.pkg)\n      pkg = \"wiki-plugin-#{req.params.pkg}\"\n      res.setHeader 'Content-Type', 'application/json'\n      execFile('npm', ['view', \"#{pkg}\", '--json']).stdout.pipe(res)\n\n  app.post route('install'), admin, (req, res) ->\n    if /^\\w+$/.test(req.body.plugin) and /^[\\w.-]+$/.test(req.body.version)\n      pkg = \"wiki-plugin-#{req.body.plugin}@#{req.body.version}\"\n      console.log \"plugmatic installing #{pkg}\"\n      execFile 'npm', ['install', \"#{pkg}\", '--json'], {cwd: argv.packageDir+'/..'}, (err, stdout, stderr) ->\n        try npm = JSON.parse stdout\n        if err\n          res.status(400).json {error: 'server unable to install plugin', npm, stderr}\n        else\n          info \"wiki-plugin-#{req.body.plugin}\", (err, row) ->\n            res.json {installed: req.body.version, npm, stderr, row}\n\n  app.post route('restart'), admin, (req, res) ->\n    console.log 'plugmatic exit to restart'\n    res.sendStatus 200\n    process.exit 0\n\n\nmodule.exports = {startServer}\n"
  ],
  "mappings": "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"
}